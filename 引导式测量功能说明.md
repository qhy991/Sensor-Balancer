# 引导式测量功能说明

## 📋 功能概述

引导式测量功能为局部传感器灵敏度检验提供了可视化的按压引导，通过图形界面指导用户按照指定位置进行按压，确保测试的准确性和一致性。

## 🎯 主要特性

### 1. 可视化引导窗口
- **64x64传感器网格显示**: 清晰显示传感器阵列布局
- **当前位置高亮**: 红色大圆点标记需要按压的位置
- **闪烁效果**: 黄色闪烁圆圈增强视觉引导
- **位置信息显示**: 实时显示坐标和偏移量信息
- **其他位置预览**: 灰色小点显示所有测试位置

### 2. 交互式控制
- **手动数据记录**: 按压后手动点击"记录数据"按钮
- **自动位置切换**: 点击"下一个位置"自动记录并切换
- **位置回退**: 点击"上一个位置"返回修改
- **实时状态更新**: 动态显示当前测试进度

### 3. 智能提示系统
- **开始提示**: 详细的操作说明和注意事项
- **位置完成提示**: 每个位置完成后的确认信息
- **测试完成提示**: 所有位置测试完成的通知

## 🚀 使用流程

### 步骤1: 准备工作
1. 在右侧标签页中选择"局部灵敏度检验"
2. 选择一个预定义区域（如：中心区域）
3. 设置测试参数：
   - 微小变化范围：1-10像素
   - 微调位置数量：5-20个
   - 每位置帧数：5-100帧
   - 砝码ID：输入测试用的砝码标识

### 步骤2: 生成测试位置
1. 点击"生成微调位置"按钮
2. 系统在选定区域周围生成随机微调位置
3. 位置表格显示所有生成的位置信息

### 步骤3: 启动引导式测试
1. 点击"开始引导式测试"按钮
2. 系统显示引导窗口和操作说明
3. 引导窗口显示64x64传感器网格

### 步骤4: 执行按压测试
1. **观察引导窗口**：
   - 红色大圆点：当前需要按压的位置
   - 黄色闪烁圆圈：增强视觉效果
   - 灰色小点：其他测试位置
   - 位置标签：显示坐标和偏移信息

2. **执行按压**：
   - 按照红色标记位置进行按压
   - 确保按压力度和持续时间一致
   - 等待系统采集数据

3. **记录数据**：
   - 方式1：点击"记录数据"按钮手动记录
   - 方式2：点击"下一个位置"自动记录并切换
   - 方式3：点击"上一个位置"返回修改

### 步骤5: 完成测试
1. 系统自动检测所有位置完成
2. 显示测试完成提示
3. 引导窗口自动关闭
4. 启用分析功能按钮

## 🔧 技术实现

### 引导窗口创建
```python
def create_guide_window(self):
    """创建引导窗口"""
    self.guide_window = pg.GraphicsLayoutWidget()
    self.guide_plot = self.guide_window.addPlot()
    # 设置坐标轴、网格、范围等
```

### 位置标记显示
```python
def update_guide_display(self):
    """更新引导显示"""
    # 当前位置：红色大圆点 + 闪烁圆圈
    # 其他位置：灰色小点
    # 位置标签：坐标和偏移信息
```

### 数据采集控制
```python
def record_position_data(self):
    """记录当前位置的数据"""
    # 获取传感器数据
    # 记录到数据结构
    # 更新进度和状态
```

## 📊 界面布局

### 主界面组件
- **预定义区域管理**: 9个预设测试区域
- **测试参数设置**: 变化范围、位置数量、帧数等
- **测试控制按钮**: 
  - 生成微调位置
  - 开始灵敏度测试（自动）
  - 开始引导式测试（可视化）
  - 停止测试
- **手动控制按钮**:
  - 下一个位置
  - 上一个位置
  - 记录数据
- **状态显示**: 实时测试状态和进度条

### 引导窗口组件
- **传感器网格**: 64x64网格显示
- **位置标记**: 颜色编码的位置指示
- **信息标签**: 坐标和偏移量显示
- **闪烁效果**: 动态视觉引导

## 🎨 视觉设计

### 颜色编码
- **红色**: 当前需要按压的位置
- **黄色**: 闪烁引导效果
- **灰色**: 其他测试位置
- **绿色**: 测试完成状态
- **蓝色**: 测试进行中状态

### 动画效果
- **闪烁圆圈**: 500ms间隔的黄色闪烁
- **状态更新**: 实时状态文字更新
- **进度条**: 动态进度显示

## ⚠️ 注意事项

### 操作建议
1. **按压一致性**: 确保每个位置的按压力度和时间一致
2. **位置准确性**: 严格按照红色标记位置进行按压
3. **数据完整性**: 确保每个位置都完成数据采集
4. **环境稳定**: 测试过程中保持环境稳定

### 技术限制
1. **PyQtGraph依赖**: 需要PyQtGraph模块支持
2. **传感器数据**: 当前使用模拟数据，需要替换为真实传感器接口
3. **窗口管理**: 引导窗口需要手动关闭或自动关闭

## 🔮 后续优化

### 功能增强
1. **自动检测**: 集成真实传感器数据自动检测按压
2. **声音提示**: 添加声音引导和提示
3. **批量操作**: 支持批量位置测试
4. **数据验证**: 实时数据质量检查

### 用户体验
1. **操作简化**: 进一步简化操作流程
2. **错误处理**: 增强错误提示和处理
3. **帮助系统**: 添加详细的操作帮助
4. **快捷键**: 支持键盘快捷键操作

---

**功能状态**: ✅ 已完成
**测试状态**: ✅ 已验证
**文档版本**: v1.0 