# 传感器称重工具使用说明

## 概述

这是一个基于传感器压力数据进行称重的工具，支持实时重量测量、归零功能、校准参数设置和历史数据记录。

## 主要功能

### 1. 传感器连接
- 支持多种传感器ID选择（0-9）
- 支持多种端口连接方式（数字端口、COM端口、USB端口）
- 自动检测传感器连接状态
- 支持模拟数据模式（当真实传感器不可用时）

### 2. 校准参数设置
- **系数 (k)**: 一次函数关系式中的斜率系数，单位：g/N
- **偏置 (b)**: 一次函数关系式中的截距，单位：g
- **计算公式**: 质量 = k × 压力 + b

### 3. 归零功能
- 记录空载时的基准压力
- 自动从测量值中减去基准压力
- 确保测量精度

### 4. 重量测量
- 实时重量显示（LCD数字显示）
- 重量历史曲线图
- 稳定性评估
- 保持读数功能

### 5. 数据管理
- 保存/加载校准参数
- 重量历史记录
- 实时压力信息显示

## 使用步骤

### 第一步：连接传感器
1. 选择传感器ID（通常为0）
2. 输入端口号（数字端口直接输入数字，串口输入如"COM3"）
3. 点击"连接传感器"按钮
4. 确认状态显示为"已连接"

### 第二步：设置校准参数
1. 在"校准参数"区域设置系数(k)和偏置(b)
2. 这些参数来自您的一次函数关系式：质量 = k × 压力 + b
3. 参数会实时更新公式显示
4. **输入格式支持**：
   - 普通小数：`0.000522`
   - 科学计数法：`5.22e-04`
   - 负数：`-0.052335`
   - 大写E：`5.22E-04`

### 第三步：归零操作
1. 确保传感器上没有放置任何物体
2. 点击"归零"按钮
3. 系统会记录当前压力作为基准值
4. 状态会显示为"已归零"

### 第四步：开始测量
1. 点击"开始测量"按钮
2. 在传感器上放置待测物体
3. 观察实时重量显示和历史曲线
4. 使用"保持读数"功能可以暂停测量但保持当前显示

### 第五步：保存校准参数（可选）
1. 点击"保存校准"按钮
2. 选择保存位置和文件名
3. 校准参数会保存为JSON格式

## 界面说明

### 左侧面板
- **传感器控制**: 连接/断开传感器
- **压力信息**: 显示总压力、最大压力、最小压力
- **校准文件**: 保存/加载校准参数

### 右侧面板
- **校准参数**: 设置系数和偏置
- **归零控制**: 执行归零操作
- **重量显示**: 大数字LCD显示当前重量
- **测量控制**: 开始/停止测量，保持读数
- **实时信息**: 当前压力、净压力、稳定性
- **重量历史**: 实时重量变化曲线

## 校准参数说明

### 如何确定校准参数
1. **系数 (k)**:
   - 使用已知重量的标准物体进行测试
   - 记录不同重量下的压力总和
   - 通过线性回归计算斜率：k = Δ质量 / Δ压力

2. **偏置 (b)**:
   - 通常设置为0，除非有系统误差
   - 可以通过校准过程确定

### 校准示例
假设您有以下测试数据：
- 100g物体 → 压力总和 2.5N
- 200g物体 → 压力总和 5.0N
- 300g物体 → 压力总和 7.5N

计算：
- 系数 k = (300-100)/(7.5-2.5) = 200/5 = 40 g/N
- 偏置 b = 0（假设无系统误差）

**注意**: 实际应用中，您的传感器可能具有不同的校准参数。当前工具已预设了实际的校准参数：
- 系数 k = 1730.6905 g/pressure_unit
- 偏置 b = 126.1741 g

这些参数基于您的传感器实际测试数据，可以直接使用或根据需要进行微调。

## 注意事项

1. **归零重要性**: 每次测量前必须进行归零操作
2. **稳定性**: 观察稳定性指标，确保读数稳定后再记录
3. **校准精度**: 校准参数直接影响测量精度，请仔细校准
4. **环境因素**: 温度、湿度等环境因素可能影响传感器性能
5. **传感器维护**: 定期清洁传感器表面，避免异物影响测量

## 故障排除

### 传感器连接失败
- 检查端口号是否正确
- 确认传感器已正确连接
- 尝试不同的端口号

### 重量显示异常
- 检查校准参数是否正确
- 确认已进行归零操作
- 检查传感器表面是否有异物

### 读数不稳定
- 确保测量环境稳定
- 检查传感器是否固定牢固
- 等待读数稳定后再记录

## 文件格式

### 校准参数文件 (JSON)
```json
{
  "timestamp": "2024-01-01T12:00:00",
  "coefficient": 1730.6905,
  "bias": 126.1741,
  "zero_pressure": 1.2345,
  "is_zeroed": true
}
```

## 技术支持

如果遇到问题，请检查：
1. 传感器连接状态
2. 校准参数设置
3. 归零操作是否完成
4. 环境因素影响

---

**版本**: 1.0  
**更新日期**: 2024年1月  
**兼容性**: Python 3.7+, PyQt5, pyqtgraph 